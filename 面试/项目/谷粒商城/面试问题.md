- 登录状态是如何保持的？在高并发下会不会存在问题？

    ```
    1）用户登录后会：
    ① 存储用户信息到redis中
    ② 在HTTP响应头中添加Set-Cookie，内容为SessionId，下一次用户请求时就会带上该包含SessionId的cookie进行访问
    ③ 登录用户访问时可以根据SessionId查找出用户信息
    2）自动续期是怎么完成的，时间多长？
    ① 使用SpringSession+Redis时，每次session.get/set都会顺带更新redis中的过期时间，实现用户登录信息的续期（Session续期）
    ② cookie则会在返回响应数据时在HTTP响应头添加Set-Cookie，设置Cookie的MaxAge信息（Cookie续期）
    ③ 默认登录时间设置为7天
    ```

- 上架秒杀商品
① 上架商品时锁商品库存 ② 活动开始定时任务：启动秒杀活动结束定时任务或使用延时队列(时间为秒杀结束)，此时回收未被购买的秒杀商品，回收后解锁库存

- 用户秒杀商品：
秒杀服务：{ 校验+抢分布式信号量 -> 生成订单相关信息放入消息队列 }
订单服务：{ 监听消息队列，获取用户即sku等相关信息生成订单 -> 将**订单实体添加到消息队列(路由到order.delay.queue)** (后续如果订单未支付会完成自动解锁库存的流程) }
当前是秒杀活动中**已抢到但未付款**的商品**不会返还到秒杀场次中**，如果需要返还到该场次，则需要在上面的发送到消息队列的订单信息中添加是否是秒杀商品的标识，如果是秒杀商品则不解锁库存，而是返回到秒杀场次中

- 用户支付后如果消息还未消费（订单还未被创建）如何解决？
收到支付宝发送的订单支付成功后，先往数据库中插入一条只包含订单号和订单状态的记录，这样在消息被消费时创建订单时此订单状态为“已支付”，不再放入队列order.delay.queue中进行延时解锁等操作

- 退出登录删除session信息
session.invalidation


## 问题

1. 是否需要给cookie续期
2. 秒杀后未付款的商品是否需要添加回秒杀场
3. 用户秒杀支付后如果消息还未被消费，查询订单状态该如何显示
4. Redisson分布式锁热键问题
5. 一场秒杀只有一个token吗？面试被问到这个，按面试官的意思是只有一个会有问题，我也不知道具体是哪些问题
6. 秒杀商品锁库存回收如何实现

