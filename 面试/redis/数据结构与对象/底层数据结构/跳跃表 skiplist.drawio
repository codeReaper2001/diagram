<mxfile host="65bd71144e">
    <diagram id="R2xw_Hb9G4WMJBaGmHiY" name="第 1 页">
        <mxGraphModel dx="1161" dy="670" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="4" style="edgeStyle=none;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;sketch=1;" edge="1" parent="1" source="2" target="3">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="8" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="2" target="7">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="16" style="edgeStyle=orthogonalEdgeStyle;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;" edge="1" parent="1" source="2" target="15">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="2" value="跳跃表&lt;br&gt;skiplist" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;comic=1;" vertex="1" parent="1">
                    <mxGeometry x="40" y="120" width="80" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="6" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="3" target="5">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="3" value="特点" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#b0e3e6;strokeColor=#0e8088;comic=1;" vertex="1" parent="1">
                    <mxGeometry x="160" y="50" width="60" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="5" value="跳表是一种在平均情况下在O(logn)时间内完成元素查找的数据结构，且内部元素有序，可以实现区间查询" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;comic=1;align=left;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="260" y="37.5" width="210" height="55" as="geometry"/>
                </mxCell>
                <mxCell id="10" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="7" target="9">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="7" value="用途" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;comic=1;" vertex="1" parent="1">
                    <mxGeometry x="160" y="125" width="60" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="12" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="9" target="11">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="9" value="是&lt;b&gt;有序集合zset键&lt;/b&gt;的一种实现方式" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;comic=1;align=left;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="260" y="126.25" width="190" height="27.5" as="geometry"/>
                </mxCell>
                <mxCell id="11" value="① 当集合包含的元素数量较多&lt;br&gt;② 有序集合中元素成员是比较长的字符串&lt;br&gt;时采用该数据结构" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;comic=1;align=left;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="480" y="113.75" width="230" height="52.5" as="geometry"/>
                </mxCell>
                <mxCell id="22" style="edgeStyle=orthogonalEdgeStyle;curved=1;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=12;" edge="1" parent="1" source="15" target="21">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="23" style="edgeStyle=orthogonalEdgeStyle;curved=1;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=12;" edge="1" parent="1" source="15" target="17">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="42" style="edgeStyle=orthogonalEdgeStyle;curved=1;sketch=1;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=12;" edge="1" parent="1" source="17" target="41">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="45" style="edgeStyle=orthogonalEdgeStyle;curved=1;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=12;" edge="1" parent="1" source="15" target="44">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="250" y="333"/>
                            <mxPoint x="250" y="960"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="67" style="edgeStyle=orthogonalEdgeStyle;rounded=0;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=12;curved=1;" edge="1" parent="1" source="15" target="64">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="240" y="333"/>
                            <mxPoint x="240" y="1270"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="15" value="相关源码" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;comic=1;" vertex="1" parent="1">
                    <mxGeometry x="150" y="316" width="70" height="34" as="geometry"/>
                </mxCell>
                <mxCell id="20" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=12;" edge="1" parent="1" source="17" target="19">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="17" value="最外层zskiplist结构" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#b0e3e6;strokeColor=#0e8088;comic=1;" vertex="1" parent="1">
                    <mxGeometry x="270" y="233" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="19" value="&lt;div style=&quot;color: rgb(56 , 58 , 66) ; background-color: rgb(250 , 250 , 250) ; font-family: &amp;#34;consolas&amp;#34; , &amp;#34;courier new&amp;#34; , monospace ; line-height: 22px&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #a0a1a7 ; font-style: italic&quot;&gt;/*&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;color: rgb(160 , 161 , 167) ; font-style: italic&quot;&gt;跳跃表&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;color: rgb(160 , 161 , 167) ; font-style: italic&quot;&gt;*/&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a626a4&quot;&gt;typedef&lt;/span&gt; &lt;span style=&quot;color: #a626a4&quot;&gt;struct&lt;/span&gt; &lt;span style=&quot;color: #c18401&quot;&gt;zskiplist&lt;/span&gt; {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #a626a4&quot;&gt;struct&lt;/span&gt; &lt;span style=&quot;color: #c18401&quot;&gt;zskiplistNode&lt;/span&gt; &lt;span style=&quot;color: #a626a4&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e45649&quot;&gt;header&lt;/span&gt;, &lt;span style=&quot;color: #a626a4&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e45649&quot;&gt;tail&lt;/span&gt;;&lt;span style=&quot;color: rgb(160 , 161 , 167) ; font-style: italic&quot;&gt;// 表头节点和表尾节点&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #a626a4&quot;&gt;unsigned&lt;/span&gt; &lt;span style=&quot;color: #a626a4&quot;&gt;long&lt;/span&gt; &lt;span style=&quot;color: #e45649&quot;&gt;length&lt;/span&gt;;&lt;span style=&quot;color: rgb(160 , 161 , 167) ; font-style: italic&quot;&gt;// 表中节点的数量&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #a626a4&quot;&gt;int&lt;/span&gt; &lt;span style=&quot;color: #e45649&quot;&gt;level&lt;/span&gt;;&lt;span style=&quot;color: rgb(160 , 161 , 167) ; font-style: italic&quot;&gt;// 表中层数最大的节点的层数&lt;/span&gt;&lt;/div&gt;&lt;div&gt;} &lt;span style=&quot;color: #c18401&quot;&gt;zskiplist&lt;/span&gt;;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;comic=1;align=left;" vertex="1" parent="1">
                    <mxGeometry x="422" y="180" width="405" height="136" as="geometry"/>
                </mxCell>
                <mxCell id="25" style="edgeStyle=orthogonalEdgeStyle;curved=1;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=12;" edge="1" parent="1" source="21" target="24">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="21" value="跳表节点zskiplistNode" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#b0e3e6;strokeColor=#0e8088;comic=1;" vertex="1" parent="1">
                    <mxGeometry x="270" y="410" width="110" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="39" style="edgeStyle=orthogonalEdgeStyle;curved=1;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontSize=12;entryX=0;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="24" target="31">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="830" y="430" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="790" y="430"/>
                            <mxPoint x="790" y="430"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="24" value="&lt;div style=&quot;color: rgb(56 , 58 , 66) ; background-color: rgb(250 , 250 , 250) ; font-family: &amp;#34;consolas&amp;#34; , &amp;#34;courier new&amp;#34; , monospace ; line-height: 22px&quot;&gt;&lt;div style=&quot;font-family: &amp;#34;consolas&amp;#34; , &amp;#34;courier new&amp;#34; , monospace ; line-height: 22px&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #a626a4&quot;&gt;typedef&lt;/span&gt; &lt;span style=&quot;color: #a626a4&quot;&gt;struct&lt;/span&gt; &lt;span style=&quot;color: #c18401&quot;&gt;zskiplistNode&lt;/span&gt; {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #c18401&quot;&gt;robj&lt;/span&gt; &lt;span style=&quot;color: #a626a4&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e45649&quot;&gt;obj&lt;/span&gt;;&lt;span style=&quot;color: rgb(160 , 161 , 167) ; font-style: italic&quot;&gt;// 成员对象 指向一个字符串对象&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #a626a4&quot;&gt;double&lt;/span&gt; &lt;span style=&quot;color: #e45649&quot;&gt;score&lt;/span&gt;;&lt;span style=&quot;color: rgb(160 , 161 , 167) ; font-style: italic&quot;&gt;// 分值&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #a626a4&quot;&gt;struct&lt;/span&gt; &lt;span style=&quot;color: #c18401&quot;&gt;zskiplistNode&lt;/span&gt; &lt;span style=&quot;color: #a626a4&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e45649&quot;&gt;backward&lt;/span&gt;;&lt;span style=&quot;color: rgb(160 , 161 , 167) ; font-style: italic&quot;&gt;// 后退指针&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #a626a4&quot;&gt;struct&lt;/span&gt; &lt;span style=&quot;color: #c18401&quot;&gt;zskiplistLevel&lt;/span&gt; {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #a626a4&quot;&gt;struct&lt;/span&gt; &lt;span style=&quot;color: #c18401&quot;&gt;zskiplistNode&lt;/span&gt; &lt;span style=&quot;color: #a626a4&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e45649&quot;&gt;forward&lt;/span&gt;;&lt;span style=&quot;color: rgb(160 , 161 , 167) ; font-style: italic&quot;&gt;// 前进指针&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #a626a4&quot;&gt;unsigned&lt;/span&gt; &lt;span style=&quot;color: #a626a4&quot;&gt;int&lt;/span&gt; &lt;span style=&quot;color: #e45649&quot;&gt;span&lt;/span&gt;;&lt;span style=&quot;color: rgb(160 , 161 , 167) ; font-style: italic&quot;&gt;// 跨度&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; } &lt;span style=&quot;color: #e45649&quot;&gt;level&lt;/span&gt;&lt;span style=&quot;color: #a626a4&quot;&gt;[]&lt;/span&gt;;&lt;span style=&quot;color: rgb(160 , 161 , 167) ; font-style: italic&quot;&gt;// 层&lt;/span&gt;&lt;/div&gt;&lt;div&gt;} &lt;span style=&quot;color: #c18401&quot;&gt;zskiplistNode&lt;/span&gt;;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;comic=1;align=left;" vertex="1" parent="1">
                    <mxGeometry x="422" y="330" width="328" height="200" as="geometry"/>
                </mxCell>
                <mxCell id="38" value="" style="group" vertex="1" connectable="0" parent="1">
                    <mxGeometry x="810" y="330" width="110" height="200" as="geometry"/>
                </mxCell>
                <mxCell id="27" value="obj" style="rounded=0;whiteSpace=wrap;html=1;comic=0;" vertex="1" parent="38">
                    <mxGeometry y="25" width="110.00000000000001" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="28" value="zskiplistNode" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;comic=0;" vertex="1" parent="38">
                    <mxGeometry width="110.00000000000001" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="74" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;sketch=1;html=1;exitX=0.75;exitY=0;exitDx=0;exitDy=0;entryX=0.75;entryY=1;entryDx=0;entryDy=0;fontSize=12;" edge="1" parent="38" source="29" target="27">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="29" value="score" style="rounded=0;whiteSpace=wrap;html=1;comic=0;" vertex="1" parent="38">
                    <mxGeometry y="50" width="110.00000000000001" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="30" value="backward" style="rounded=0;whiteSpace=wrap;html=1;comic=0;" vertex="1" parent="38">
                    <mxGeometry y="75" width="110.00000000000001" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="31" value="level" style="rounded=0;whiteSpace=wrap;html=1;comic=0;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="38">
                    <mxGeometry y="100" width="110.00000000000001" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="32" value="span" style="rounded=0;whiteSpace=wrap;html=1;comic=0;" vertex="1" parent="38">
                    <mxGeometry y="125" width="41.25" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="33" value="forward" style="rounded=0;whiteSpace=wrap;html=1;comic=0;" vertex="1" parent="38">
                    <mxGeometry x="41.25" y="125" width="68.75" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="34" value="span" style="rounded=0;whiteSpace=wrap;html=1;comic=0;" vertex="1" parent="38">
                    <mxGeometry y="150" width="41.25" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="35" value="forward" style="rounded=0;whiteSpace=wrap;html=1;comic=0;" vertex="1" parent="38">
                    <mxGeometry x="41.25" y="150" width="68.75" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="36" value="..." style="rounded=0;whiteSpace=wrap;html=1;comic=0;" vertex="1" parent="38">
                    <mxGeometry y="175" width="41.25" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="37" value="..." style="rounded=0;whiteSpace=wrap;html=1;comic=0;" vertex="1" parent="38">
                    <mxGeometry x="41.25" y="175" width="68.75" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="40" value="" style="shape=image;imageAspect=0;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;sketch=1;fontSize=12;image=https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/image-20220911212054191.png;imageBorder=default;" vertex="1" parent="1">
                    <mxGeometry x="422" y="546.75" width="520" height="193" as="geometry"/>
                </mxCell>
                <mxCell id="43" style="edgeStyle=orthogonalEdgeStyle;curved=1;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=12;" edge="1" parent="1" source="41" target="40">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="41" value="示意图" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;comic=1;" vertex="1" parent="1">
                    <mxGeometry x="290" y="626.5" width="70" height="33.5" as="geometry"/>
                </mxCell>
                <mxCell id="47" style="edgeStyle=orthogonalEdgeStyle;curved=1;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=12;" edge="1" parent="1" source="44" target="46">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="44" value="根据rank获取元素" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#b0e3e6;strokeColor=#0e8088;comic=1;" vertex="1" parent="1">
                    <mxGeometry x="270" y="940" width="110" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="63" style="edgeStyle=orthogonalEdgeStyle;rounded=0;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=12;" edge="1" parent="1" source="46" target="48">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="46" value="&lt;div style=&quot;color: rgb(56 , 58 , 66) ; background-color: rgb(250 , 250 , 250) ; font-family: &amp;#34;consolas&amp;#34; , &amp;#34;courier new&amp;#34; , monospace ; line-height: 22px&quot;&gt;&lt;div style=&quot;font-family: &amp;#34;consolas&amp;#34; , &amp;#34;courier new&amp;#34; , monospace ; line-height: 22px&quot;&gt;&lt;div style=&quot;font-family: &amp;#34;consolas&amp;#34; , &amp;#34;courier new&amp;#34; , monospace ; line-height: 22px&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #c18401&quot;&gt;zskiplistNode&lt;/span&gt;&lt;span style=&quot;color: #a626a4&quot;&gt;*&lt;/span&gt; &lt;span style=&quot;color: #4078f2&quot;&gt;zslGetElementByRank&lt;/span&gt;(&lt;span style=&quot;color: #c18401&quot;&gt;zskiplist&lt;/span&gt; &lt;span style=&quot;color: #a626a4&quot;&gt;*&lt;/span&gt;zsl, &lt;span style=&quot;color: #a626a4&quot;&gt;unsigned&lt;/span&gt; &lt;span style=&quot;color: #a626a4&quot;&gt;long&lt;/span&gt; rank) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #c18401&quot;&gt;zskiplistNode&lt;/span&gt; &lt;span style=&quot;color: #a626a4&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e45649&quot;&gt;x&lt;/span&gt;;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #a626a4&quot;&gt;unsigned&lt;/span&gt; &lt;span style=&quot;color: #a626a4&quot;&gt;long&lt;/span&gt; &lt;span style=&quot;color: #e45649&quot;&gt;traversed&lt;/span&gt; &lt;span style=&quot;color: #a626a4&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color: #986801&quot;&gt;0&lt;/span&gt;;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #a626a4&quot;&gt;int&lt;/span&gt; &lt;span style=&quot;color: #e45649&quot;&gt;i&lt;/span&gt;;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #a0a1a7 ; font-style: italic&quot;&gt;// T_wrost = O(N), T_avg = O(log N)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #e45649&quot;&gt;x&lt;/span&gt; &lt;span style=&quot;color: #a626a4&quot;&gt;=&lt;/span&gt; zsl-&amp;gt;&lt;span style=&quot;color: #e45649&quot;&gt;header&lt;/span&gt;;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #a626a4&quot;&gt;for&lt;/span&gt; (&lt;span style=&quot;color: #e45649&quot;&gt;i&lt;/span&gt; &lt;span style=&quot;color: #a626a4&quot;&gt;=&lt;/span&gt; zsl-&amp;gt;&lt;span style=&quot;color: #e45649&quot;&gt;level&lt;/span&gt;&lt;span style=&quot;color: #a626a4&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #986801&quot;&gt;1&lt;/span&gt;; &lt;span style=&quot;color: #e45649&quot;&gt;i&lt;/span&gt; &lt;span style=&quot;color: #a626a4&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span style=&quot;color: #986801&quot;&gt;0&lt;/span&gt;; &lt;span style=&quot;color: #e45649&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #a626a4&quot;&gt;--&lt;/span&gt;) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #a0a1a7 ; font-style: italic&quot;&gt;// 遍历跳跃表并累积越过的节点数量&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #a626a4&quot;&gt;while&lt;/span&gt; (&lt;span style=&quot;color: #e45649&quot;&gt;x&lt;/span&gt;-&amp;gt;&lt;span style=&quot;color: #e45649&quot;&gt;level&lt;/span&gt;[&lt;span style=&quot;color: #e45649&quot;&gt;i&lt;/span&gt;].&lt;span style=&quot;color: #e45649&quot;&gt;forward&lt;/span&gt; &lt;span style=&quot;color: #a626a4&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; (&lt;span style=&quot;color: #e45649&quot;&gt;traversed&lt;/span&gt; &lt;span style=&quot;color: #a626a4&quot;&gt;+&lt;/span&gt; &lt;span style=&quot;color: #e45649&quot;&gt;x&lt;/span&gt;-&amp;gt;&lt;span style=&quot;color: #e45649&quot;&gt;level&lt;/span&gt;[&lt;span style=&quot;color: #e45649&quot;&gt;i&lt;/span&gt;].&lt;span style=&quot;color: #e45649&quot;&gt;span&lt;/span&gt;) &lt;span style=&quot;color: #a626a4&quot;&gt;&amp;lt;=&lt;/span&gt; rank) {&amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #e45649&quot;&gt;traversed&lt;/span&gt; &lt;span style=&quot;color: #a626a4&quot;&gt;+=&lt;/span&gt; &lt;span style=&quot;color: #e45649&quot;&gt;x&lt;/span&gt;-&amp;gt;&lt;span style=&quot;color: #e45649&quot;&gt;level&lt;/span&gt;[&lt;span style=&quot;color: #e45649&quot;&gt;i&lt;/span&gt;].&lt;span style=&quot;color: #e45649&quot;&gt;span&lt;/span&gt;;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #e45649&quot;&gt;x&lt;/span&gt; &lt;span style=&quot;color: #a626a4&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color: #e45649&quot;&gt;x&lt;/span&gt;-&amp;gt;&lt;span style=&quot;color: #e45649&quot;&gt;level&lt;/span&gt;[&lt;span style=&quot;color: #e45649&quot;&gt;i&lt;/span&gt;].&lt;span style=&quot;color: #e45649&quot;&gt;forward&lt;/span&gt;;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #a0a1a7 ; font-style: italic&quot;&gt;//&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;color: rgb(160 , 161 , 167) ; font-style: italic&quot;&gt;如果越过的节点数量已经等于 rank&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;color: rgb(160 , 161 , 167) ; font-style: italic&quot;&gt;那么说明已经到达要找的节点&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #a626a4&quot;&gt;if&lt;/span&gt; (&lt;span style=&quot;color: #e45649&quot;&gt;traversed&lt;/span&gt; &lt;span style=&quot;color: #a626a4&quot;&gt;==&lt;/span&gt; rank) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #a626a4&quot;&gt;return&lt;/span&gt; &lt;span style=&quot;color: #e45649&quot;&gt;x&lt;/span&gt;;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #a626a4&quot;&gt;return&lt;/span&gt; &lt;span style=&quot;color: #4078f2&quot;&gt;NULL&lt;/span&gt;;&amp;nbsp;&lt;span style=&quot;color: rgb(160 , 161 , 167) ; font-style: italic&quot;&gt;// 没找到目标节点&lt;/span&gt;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;comic=1;align=left;" vertex="1" parent="1">
                    <mxGeometry x="422" y="750" width="535" height="420" as="geometry"/>
                </mxCell>
                <mxCell id="62" value="" style="group" vertex="1" connectable="0" parent="1">
                    <mxGeometry x="1000" y="800" width="330" height="320" as="geometry"/>
                </mxCell>
                <mxCell id="48" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;comic=1;" vertex="1" parent="62">
                    <mxGeometry width="330" height="320" as="geometry"/>
                </mxCell>
                <mxCell id="49" value="i=最高层数" style="rounded=0;whiteSpace=wrap;html=1;comic=1;" vertex="1" parent="62">
                    <mxGeometry x="90" y="20" width="80" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="50" value="x=下一个节点" style="rounded=0;whiteSpace=wrap;html=1;comic=1;" vertex="1" parent="62">
                    <mxGeometry x="90" y="70" width="80" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="51" style="edgeStyle=orthogonalEdgeStyle;curved=1;sketch=1;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=12;" edge="1" parent="62" source="49" target="50">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="52" value="若当前节点的level[i].forward不为空，且未达到rank，则循环迭代到下一个元素（迭代x）" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#b0e3e6;strokeColor=#0e8088;align=left;" vertex="1" parent="62">
                    <mxGeometry x="40" y="120" width="180" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="54" style="edgeStyle=orthogonalEdgeStyle;curved=1;sketch=1;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=12;" edge="1" parent="62" source="50" target="52">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="57" value="未到达" style="edgeStyle=orthogonalEdgeStyle;sketch=1;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=12;rounded=0;" edge="1" parent="62" source="55" target="50">
                    <mxGeometry x="0.48" relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="30" y="215"/>
                            <mxPoint x="30" y="85"/>
                        </Array>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="55" value="到达rank?" style="rhombus;whiteSpace=wrap;html=1;sketch=0;fontSize=12;fillColor=#ffe6cc;strokeColor=#d79b00;comic=1;" vertex="1" parent="62">
                    <mxGeometry x="90" y="200" width="80" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="56" style="edgeStyle=orthogonalEdgeStyle;curved=1;sketch=1;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=12;" edge="1" parent="62" source="52" target="55">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="58" value="返回x" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="62">
                    <mxGeometry x="100" y="270" width="60" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="59" value="是" style="edgeStyle=orthogonalEdgeStyle;rounded=0;sketch=1;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=12;" edge="1" parent="62" source="55" target="58">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="60" value="返回NULL" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="62">
                    <mxGeometry x="250" y="70" width="70" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="61" value="节点访问&lt;br&gt;完毕" style="edgeStyle=orthogonalEdgeStyle;rounded=0;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=12;" edge="1" parent="62" source="50" target="60">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="66" style="edgeStyle=orthogonalEdgeStyle;rounded=0;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=12;" edge="1" parent="1" source="64" target="65">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="64" value="插入节点时获取随机层数的函数" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#b0e3e6;strokeColor=#0e8088;comic=1;" vertex="1" parent="1">
                    <mxGeometry x="270" y="1250" width="110" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="69" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=12;" edge="1" parent="1" source="65" target="68">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="65" value="&lt;div style=&quot;color: rgb(56 , 58 , 66) ; background-color: rgb(250 , 250 , 250) ; font-family: &amp;#34;consolas&amp;#34; , &amp;#34;courier new&amp;#34; , monospace ; line-height: 22px&quot;&gt;&lt;div style=&quot;font-family: &amp;#34;consolas&amp;#34; , &amp;#34;courier new&amp;#34; , monospace ; line-height: 22px&quot;&gt;&lt;div style=&quot;font-family: &amp;#34;consolas&amp;#34; , &amp;#34;courier new&amp;#34; , monospace ; line-height: 22px&quot;&gt;&lt;div style=&quot;font-family: &amp;#34;consolas&amp;#34; , &amp;#34;courier new&amp;#34; , monospace ; line-height: 22px&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #a626a4&quot;&gt;int&lt;/span&gt; &lt;span style=&quot;color: #4078f2&quot;&gt;zslRandomLevel&lt;/span&gt;(&lt;span style=&quot;color: #a626a4&quot;&gt;void&lt;/span&gt;) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #a626a4&quot;&gt;int&lt;/span&gt; &lt;span style=&quot;color: #e45649&quot;&gt;level&lt;/span&gt; &lt;span style=&quot;color: #a626a4&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color: #986801&quot;&gt;1&lt;/span&gt;;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #a626a4&quot;&gt;while&lt;/span&gt; ((&lt;span style=&quot;color: #4078f2&quot;&gt;random&lt;/span&gt;()&lt;span style=&quot;color: #a626a4&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #986801&quot;&gt;0xFFFF&lt;/span&gt;) &lt;span style=&quot;color: #a626a4&quot;&gt;&amp;lt;&lt;/span&gt; (&lt;span style=&quot;color: #4078f2&quot;&gt;ZSKIPLIST_P&lt;/span&gt; &lt;span style=&quot;color: #a626a4&quot;&gt;*&lt;/span&gt; &lt;span style=&quot;color: #986801&quot;&gt;0xFFFF&lt;/span&gt;))&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #e45649&quot;&gt;level&lt;/span&gt; &lt;span style=&quot;color: #a626a4&quot;&gt;+=&lt;/span&gt; &lt;span style=&quot;color: #986801&quot;&gt;1&lt;/span&gt;;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;color: #a626a4&quot;&gt;return&lt;/span&gt; (&lt;span style=&quot;color: #e45649&quot;&gt;level&lt;/span&gt;&lt;span style=&quot;color: #a626a4&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #4078f2&quot;&gt;ZSKIPLIST_MAXLEVEL&lt;/span&gt;) &lt;span style=&quot;color: #a626a4&quot;&gt;?&lt;/span&gt; &lt;span style=&quot;color: #e45649&quot;&gt;level&lt;/span&gt; &lt;span style=&quot;color: #a626a4&quot;&gt;:&lt;/span&gt; &lt;span style=&quot;color: #4078f2&quot;&gt;ZSKIPLIST_MAXLEVEL&lt;/span&gt;;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;comic=1;align=left;" vertex="1" parent="1">
                    <mxGeometry x="422" y="1180" width="448" height="180" as="geometry"/>
                </mxCell>
                <mxCell id="71" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=12;" edge="1" parent="1" source="68" target="70">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="68" value="其中ZSKIPLIST_P的值为0.25&lt;br&gt;这段代码的逻辑是：&lt;br&gt;① 初始层数为1&lt;br&gt;② 循环执行 level += 1&lt;br&gt;&amp;nbsp; &amp;nbsp; 2.1 当随机数&amp;lt;0.25时继续循环&lt;br&gt;&amp;nbsp; &amp;nbsp; 2.2 当随机数&amp;gt;=0.25时退出循环&lt;br&gt;③ level最大值设置为32" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;comic=1;align=left;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="910" y="1215.63" width="210" height="108.75" as="geometry"/>
                </mxCell>
                <mxCell id="70" value="各 level 的概率：&lt;br&gt;1 - 3/4&lt;br&gt;2 - 1/4 * 3/4&lt;br&gt;3 - 1/4 * 1/4 * 3/4&lt;br&gt;...&lt;br&gt;n - (1/4)&lt;sup&gt;n-1&lt;/sup&gt; * 3/4&lt;br&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;comic=1;align=left;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="1150" y="1217.81" width="110" height="104.37" as="geometry"/>
                </mxCell>
                <mxCell id="72" value="&lt;b&gt;层数越高，概率越小&lt;/b&gt;，所以这样能保证低层节点多，高层节点少" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;comic=1;align=left;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="1280" y="1239.99" width="130" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="73" value="① obj，用于指向&lt;b&gt;一个字符串对象&lt;/b&gt;&lt;br&gt;② score，用于&lt;b&gt;排序&lt;/b&gt;，先按score排，score相同时会按照obj的内容进行排序&lt;br&gt;③ backward，指向前一个节点，用于&lt;b&gt;反向遍历&lt;/b&gt;&lt;br&gt;④ level.forward，指向当前层的下一个节点&lt;br&gt;⑤ level.span，与当前层&lt;b&gt;下一个节点的距离&lt;/b&gt;，用于通过&lt;b&gt;rank&lt;/b&gt;获取元素" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;comic=1;align=left;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="957" y="375" width="260" height="110" as="geometry"/>
                </mxCell>
                <mxCell id="75" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;sketch=1;html=1;exitX=1;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=12;" edge="1" parent="1" source="30" target="73">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="940" y="430"/>
                            <mxPoint x="940" y="430"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>