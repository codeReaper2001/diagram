<mxfile host="65bd71144e">
    <diagram id="OZX5I6ocR80fXDLgr1LG" name="第 1 页">
        <mxGraphModel dx="1161" dy="670" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="164" value="" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
                    <mxGeometry x="300" y="3960" width="430" height="250" as="geometry"/>
                </mxCell>
                <mxCell id="190" style="edgeStyle=orthogonalEdgeStyle;rounded=0;sketch=1;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;startArrow=none;startFill=0;" parent="1" source="186" target="165" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="49" value="" style="shape=image;imageAspect=0;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;comic=0;sketch=1;image=https://cdn.xiaolincoding.com/gh/xiaolincoder/mysql/how_update/%E7%89%88%E6%9C%AC%E9%93%BE.png;imageBorder=default;" parent="1" vertex="1">
                    <mxGeometry x="180" y="500" width="394.64" height="170" as="geometry"/>
                </mxCell>
                <mxCell id="8" style="edgeStyle=none;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;sketch=1;" parent="1" source="2" target="4" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="9" style="edgeStyle=none;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;sketch=1;" parent="1" source="2" target="5" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="10" style="edgeStyle=none;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;sketch=1;" parent="1" source="2" target="6" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="11" style="edgeStyle=none;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;sketch=1;" parent="1" source="2" target="7" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="2" value="事务特性" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
                    <mxGeometry x="40" y="180" width="80" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="3" value="由于在MySQL中InnoDB实现了事务，因此这里都是针对InnoDB相关的内容" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;" parent="1" vertex="1">
                    <mxGeometry x="70" y="30" width="206" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="13" style="edgeStyle=none;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;sketch=1;" parent="1" source="4" target="12" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="4" value="A 原子性" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
                    <mxGeometry x="170" y="110" width="80" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="17" style="edgeStyle=none;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;sketch=1;" parent="1" source="5" target="16" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="5" value="C 一致性" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
                    <mxGeometry x="170" y="160" width="80" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="19" style="edgeStyle=none;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;sketch=1;" parent="1" source="6" target="18" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="6" value="I 隔离性" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
                    <mxGeometry x="170" y="210" width="80" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="23" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="7" target="22" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="7" value="D 持久性" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
                    <mxGeometry x="170" y="260" width="80" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="15" style="edgeStyle=none;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;sketch=1;" parent="1" source="12" target="14" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="12" value="一个事务中的所有操作，要么全部完成，要么全部不完成" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;" parent="1" vertex="1">
                    <mxGeometry x="290" y="105" width="190" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="14" value="由undo log(回滚日志)保证" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#f8cecc;strokeColor=#b85450;sketch=1;" parent="1" vertex="1">
                    <mxGeometry x="522" y="107.5" width="163" height="35" as="geometry"/>
                </mxCell>
                <mxCell id="16" value="其实就是其他三个特性共同实现的目标" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;" parent="1" vertex="1">
                    <mxGeometry x="290" y="157.5" width="210" height="35" as="geometry"/>
                </mxCell>
                <mxCell id="21" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="18" target="20" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="18" value="允许多个并发事务同时对其数据进行读写和修改的能力" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;" parent="1" vertex="1">
                    <mxGeometry x="290" y="205" width="190" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="20" value="MVCC（多版本并发控制） 或锁机制来保证的" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#f8cecc;strokeColor=#b85450;sketch=1;" parent="1" vertex="1">
                    <mxGeometry x="527" y="207.5" width="153" height="35" as="geometry"/>
                </mxCell>
                <mxCell id="25" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="22" target="24" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="22" value="事务处理结束后，对数据的修改就是永久的，即便系统故障也不会丢失" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;" parent="1" vertex="1">
                    <mxGeometry x="290" y="255" width="200" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="24" value="redo log(重做日志)保证" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#f8cecc;strokeColor=#b85450;sketch=1;" parent="1" vertex="1">
                    <mxGeometry x="527" y="257.5" width="153" height="35" as="geometry"/>
                </mxCell>
                <mxCell id="27" value="A 原子性" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
                    <mxGeometry x="374" y="350" width="80" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="30" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="28" target="29" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="50" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="28" target="49" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="28" value="数据表隐藏列" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
                    <mxGeometry x="40" y="482" width="100" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="37" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="29" target="32" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="29" value="假设一张表上设计有三个字段：id, name, balance，其对应的真实列情况如右图所示" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;" parent="1" vertex="1">
                    <mxGeometry x="180" y="420" width="160" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="38" value="其中trx_id和roll_pointer就是对应的隐藏列字段：&lt;br&gt;trx_id：当前记录的修改事务id&lt;br&gt;roll_pointer：回滚指针，指向修改前的旧记录(undo log内)，这个链表就被称为版本链" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;align=left;" parent="1" vertex="1">
                    <mxGeometry x="590" y="482" width="180" height="95" as="geometry"/>
                </mxCell>
                <mxCell id="39" value="" style="group" parent="1" vertex="1" connectable="0">
                    <mxGeometry x="390" y="435" width="250" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="31" value="" style="rounded=0;whiteSpace=wrap;html=1;comic=0;" parent="39" vertex="1">
                    <mxGeometry width="250" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="32" value="id" style="rounded=0;whiteSpace=wrap;html=1;comic=0;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="39" vertex="1">
                    <mxGeometry width="30" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="33" value="name" style="rounded=0;whiteSpace=wrap;html=1;comic=0;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="39" vertex="1">
                    <mxGeometry x="30" width="40" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="34" value="balance" style="rounded=0;whiteSpace=wrap;html=1;comic=0;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="39" vertex="1">
                    <mxGeometry x="70" width="60" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="35" value="trx_id" style="rounded=0;whiteSpace=wrap;html=1;comic=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="39" vertex="1">
                    <mxGeometry x="130" width="50" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="36" value="roll_pointer" style="rounded=0;whiteSpace=wrap;html=1;comic=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="39" vertex="1">
                    <mxGeometry x="180" width="70" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="55" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="47" target="54" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="47" value="" style="shape=image;imageAspect=0;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;comic=0;sketch=1;image=https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/image-20220721004758597.png;imageBorder=default;" parent="1" vertex="1">
                    <mxGeometry x="200" y="700" width="209.88" height="340" as="geometry"/>
                </mxCell>
                <mxCell id="52" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="51" target="47" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="51" value="使用 undo log 时的事务执行过程" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
                    <mxGeometry x="40" y="850" width="100" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="53" value="参考资料：https://xiaolincoding.com/mysql/log/how_update.html" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;align=left;" parent="1" vertex="1">
                    <mxGeometry x="300" y="30" width="300" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="54" value="每当 InnoDB 引擎对一条记录进行操作（&lt;b&gt;修改、删除、新增&lt;/b&gt;）时，要把回滚时需要的信息都记录到 undo log 里，比如：&lt;br&gt;① 新增记录时记录删除操作&lt;br&gt;② 删除记录时记录新增操作&lt;br&gt;③ 更新操作时记录相反的更新操作&lt;br&gt;但在&lt;b&gt;逻辑上&lt;/b&gt;可以认为在undo log中保存了上一版本的当前行的完整数据" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;align=left;" parent="1" vertex="1">
                    <mxGeometry x="459" y="805" width="226" height="130" as="geometry"/>
                </mxCell>
                <mxCell id="56" value="出现问题进行回滚时就只需要执行undo log中记录的反操作即可" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;align=left;" parent="1" vertex="1">
                    <mxGeometry x="459" y="950" width="226" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="57" value="undo log除了用于实现原子性外还用于实现MVCC机制提供隔离性的支持，在后面隔离性的内容中分析" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#e1d5e7;strokeColor=#9673a6;sketch=1;" parent="1" vertex="1">
                    <mxGeometry x="200" y="1060" width="190" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="58" value="D 持久性" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
                    <mxGeometry x="374" y="1160" width="80" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="61" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="59" target="60" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="63" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="59" target="62" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="66" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="59" target="67" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="200" y="1578" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="71" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="59" target="70" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="59" value="缓冲池&lt;br&gt;（Buffer Pool）" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
                    <mxGeometry x="40" y="1401.5" width="100" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="60" value="当我们使用SQL语句对数据进行增删改查时，实际上都是先进行磁盘IO从磁盘读取到内存时再进行操作的。&lt;br&gt;这样直接造成的问题是如果对一部分数据进行频繁的操作时也需要频繁地进行磁盘IO，为了提高性能InnoDB使用了缓冲池机制，即&lt;b&gt;操作数据先将数据读取到缓冲池的空间中，再进行相应的数据操作&lt;/b&gt;，而再使用&lt;b&gt;后台线程将缓冲池中的脏页刷回到硬盘中&lt;/b&gt;。" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;align=left;sketch=1;" parent="1" vertex="1">
                    <mxGeometry x="200" y="1210" width="260" height="145" as="geometry"/>
                </mxCell>
                <mxCell id="62" value="" style="shape=image;imageAspect=0;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;comic=0;sketch=1;image=https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/image-20220721011044182.png;imageBorder=default;" parent="1" vertex="1">
                    <mxGeometry x="200" y="1372.5" width="520" height="98" as="geometry"/>
                </mxCell>
                <mxCell id="69" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="67" target="68" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="67" value="缓冲池内容" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
                    <mxGeometry x="200" y="1558" width="100" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="68" value="" style="shape=image;imageAspect=0;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;comic=0;sketch=1;image=https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/image-20220721011521886.png;imageBorder=default;" parent="1" vertex="1">
                    <mxGeometry x="360" y="1492.5" width="368.96" height="171" as="geometry"/>
                </mxCell>
                <mxCell id="73" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="70" target="72" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="70" value="缓冲池带来的问题" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
                    <mxGeometry x="200" y="1700" width="110" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="72" value="虽然引入缓冲池提高了数据读写效率(读写内容多了一层缓存)，但一旦中途MySQL宕机，则内存中缓冲池的内容无法写入到硬盘，则会导致数据丢失 -&amp;gt; 持久性无法满足" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;align=left;sketch=1;" parent="1" vertex="1">
                    <mxGeometry x="360" y="1680" width="250" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="76" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="74" target="75" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="80" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="74" target="79" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="88" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="74" target="86" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="74" value="使用redo log实现持久性" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
                    <mxGeometry x="40" y="1870" width="100" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="78" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="75" target="77" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="75" value="redo log是什么？" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
                    <mxGeometry x="205" y="1790" width="110" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="97" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="77" target="96" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="77" value="redo log 是物理日志，记录了某个数据页做了什么修改，当某个事务对一个数据进行了修改操作时，就会：&lt;br&gt;①先使用追加写的方式往redo log日志文件写入相应的修改操作&lt;br&gt;② 进行相应的数据修改" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;align=left;" parent="1" vertex="1">
                    <mxGeometry x="350" y="1775" width="370" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="82" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="79" target="81" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="79" value="如何保证持久性？" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
                    <mxGeometry x="205" y="1870" width="110" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="81" value="当先往redo log日志中写完了修改操作后，进行相应的数据修改后，而在Buffer Pool刷会磁盘前宕机了，那么在重新运行MySQL时即会执行写入到redo log中的命令，即将旧数据从磁盘中读取到Buffer Pool，执行相应的命令，最后等待后台线程将脏页刷回磁盘中即可" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;align=left;" parent="1" vertex="1">
                    <mxGeometry x="350" y="1855" width="370" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="86" value="" style="shape=image;imageAspect=0;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;comic=0;sketch=1;image=https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/image-20220721012821093.png;imageBorder=default;" parent="1" vertex="1">
                    <mxGeometry x="203.23" y="1940" width="493.54" height="373" as="geometry"/>
                </mxCell>
                <mxCell id="92" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="89" target="91" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="89" value="redo log和undo log的区别" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
                    <mxGeometry x="40" y="2350" width="110" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="91" value="" style="shape=image;imageAspect=0;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;comic=0;sketch=1;image=https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/image-20220721013224116.png;imageBorder=default;" parent="1" vertex="1">
                    <mxGeometry x="203.23" y="2347.25" width="463.92" height="45.5" as="geometry"/>
                </mxCell>
                <mxCell id="95" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="93" target="94" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="93" value="被修改 Undo 页面，需要记录对应 redo log 吗？" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
                    <mxGeometry x="40" y="2460" width="140" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="94" value="" style="shape=image;imageAspect=0;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;comic=0;sketch=1;image=https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/image-20220721013447257.png;imageBorder=default;" parent="1" vertex="1">
                    <mxGeometry x="220" y="2435" width="520" height="90" as="geometry"/>
                </mxCell>
                <mxCell id="96" value="这种日志先行的技术思路称为Write-Ahead Logging（WAL）" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#e1d5e7;strokeColor=#9673a6;sketch=1;align=left;" parent="1" vertex="1">
                    <mxGeometry x="750" y="1785" width="170" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="98" value="" style="shape=image;imageAspect=0;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;comic=0;sketch=1;image=https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/image-20220721013740082.png;imageBorder=default;" parent="1" vertex="1">
                    <mxGeometry x="243.24" y="2540" width="293.53" height="320" as="geometry"/>
                </mxCell>
                <mxCell id="100" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="99" target="98" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="99" value="使用了undo log和redo log后事务的完整逻辑" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
                    <mxGeometry x="40" y="2680" width="140" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="101" value="I 隔离性" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
                    <mxGeometry x="374" y="2922" width="80" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="107" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="102" target="103" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="108" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="102" target="104" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="109" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="102" target="105" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="110" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="102" target="106" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="102" value="&lt;div&gt;事务的隔离级别&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
                    <mxGeometry x="40" y="3080" width="100" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="112" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="103" target="111" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="103" value="&lt;div&gt;读未提交&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
                    <mxGeometry x="190" y="3000" width="100" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="114" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="104" target="113" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="104" value="&lt;div&gt;读已提交 RC&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
                    <mxGeometry x="190" y="3050" width="100" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="116" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="105" target="115" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="105" value="&lt;div&gt;可重复读 RR&lt;/div&gt;&lt;div&gt;默认&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
                    <mxGeometry x="190" y="3095" width="100" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="118" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="106" target="117" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="106" value="串行化" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
                    <mxGeometry x="190" y="3150" width="100" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="111" value="&lt;div&gt;一个事务还没提交时，它做的变更就能被其他事务看到&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;" parent="1" vertex="1">
                    <mxGeometry x="327.32" y="3000" width="322.68" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="113" value="&lt;div&gt;一个事务提交之后，它做的变更才能被其他事务看到&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;" parent="1" vertex="1">
                    <mxGeometry x="327.32" y="3050" width="322.68" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="115" value="&lt;div&gt;指一个事务执行过程中看到的数据，一直跟这个事务启动时看到的数据是一致的&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;align=left;" parent="1" vertex="1">
                    <mxGeometry x="327.32" y="3095" width="322.68" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="117" value="&lt;div&gt;会对记录加上读写锁，在多个事务对这条记录进行读写操作时，如果发生了读写冲突的时候，后访问的事务必须等前一个事务执行完成，才能继续执行&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;align=left;" parent="1" vertex="1">
                    <mxGeometry x="327.32" y="3150" width="322.68" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="119" value="&lt;div&gt;存在的问题&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#b0e3e6;strokeColor=#0e8088;" parent="1" vertex="1">
                    <mxGeometry x="710" y="2952" width="100" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="120" value="&lt;div&gt;脏读&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
                    <mxGeometry x="670" y="3000" width="60" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="121" value="&lt;div&gt;不可重复读&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
                    <mxGeometry x="740" y="3000" width="70" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="122" value="&lt;div&gt;幻读&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
                    <mxGeometry x="820" y="3000" width="50" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="124" value="&lt;div&gt;不可重复读&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
                    <mxGeometry x="670" y="3050" width="70" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="125" value="&lt;div&gt;幻读&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
                    <mxGeometry x="750" y="3050" width="50" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="126" value="&lt;div&gt;幻读&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
                    <mxGeometry x="670" y="3100" width="50" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="131" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="127" target="128" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="132" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="127" target="129" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="133" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="127" target="130" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="127" value="&lt;div&gt;三种并发问题&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
                    <mxGeometry x="40" y="3280" width="100" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="135" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="128" target="134" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="128" value="&lt;div&gt;脏读&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
                    <mxGeometry x="185" y="3230" width="60" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="137" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="129" target="136" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="129" value="&lt;div&gt;不可重复读&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
                    <mxGeometry x="180" y="3280" width="70" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="139" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="130" target="138" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="130" value="&lt;div&gt;幻读&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
                    <mxGeometry x="185" y="3335" width="50" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="134" value="读取到还未提交事务修改的内容" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;align=center;" parent="1" vertex="1">
                    <mxGeometry x="290" y="3230" width="182.68" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="136" value="同一事务内前后读取同一记录内容不一样" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;align=center;" parent="1" vertex="1">
                    <mxGeometry x="285.98" y="3280" width="254.02" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="138" value="同一事务内前后读取同一表整体内容不一样&lt;br&gt;（多出记录或减少记录）" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;align=center;" parent="1" vertex="1">
                    <mxGeometry x="286.99" y="3330" width="254.02" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="144" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="141" target="142" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="147" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="141" target="146" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="151" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="141" target="150" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="141" value="&lt;div&gt;MVCC机制&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
                    <mxGeometry x="40" y="3460" width="100" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="145" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="142" target="143" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="142" value="&lt;div&gt;MVCC是什么&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
                    <mxGeometry x="180" y="3400" width="100" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="143" value="&lt;div&gt;多版本并发控制的英文缩写，实现RC和RR的内部机制&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;" parent="1" vertex="1">
                    <mxGeometry x="315" y="3400" width="320" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="149" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="146" target="148" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="146" value="&lt;div&gt;简要原理&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
                    <mxGeometry x="180" y="3460" width="70" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="148" value="&lt;div&gt;在开启事务后某个查询前先获取当前数据库情况的一个快照，这样读取到的内容既是拍摄快照那一刻的数据内容&lt;/div&gt;&lt;div&gt;读已提交：事务内&lt;b&gt;每次读&lt;/b&gt;生成一个新的快照&lt;/div&gt;&lt;div&gt;可重复读：事务内&lt;b&gt;第一次读&lt;/b&gt;生成一个快照&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;align=left;" parent="1" vertex="1">
                    <mxGeometry x="300" y="3440" width="325" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="154" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="150" target="153" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="156" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="150" target="155" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="160" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="150" target="159" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="150" value="&lt;div&gt;实现快照读的数据结构&lt;span&gt;ReadView&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#b0e3e6;strokeColor=#0e8088;" parent="1" vertex="1">
                    <mxGeometry x="176" y="3656" width="100" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="153" value="" style="shape=image;imageAspect=0;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;comic=0;sketch=1;image=https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/image-20220721020515309.png;imageBorder=default;" parent="1" vertex="1">
                    <mxGeometry x="325.0799999999999" y="3590" width="354.92" height="172" as="geometry"/>
                </mxCell>
                <mxCell id="155" value="生成的每个ReadView可以理解为一个快照，通过它内部字段和数据表记录隐藏列计算可得到快照中的内容" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;align=left;" parent="1" vertex="1">
                    <mxGeometry x="325.08" y="3540" width="290" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="158" value="各个字段的内容" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#e1d5e7;strokeColor=#9673a6;sketch=1;align=center;" parent="1" vertex="1">
                    <mxGeometry x="690" y="3650" width="120" height="36" as="geometry"/>
                </mxCell>
                <mxCell id="163" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="159" target="162" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="172" style="edgeStyle=none;sketch=1;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.196;entryY=-0.012;entryDx=0;entryDy=0;startArrow=none;startFill=0;entryPerimeter=0;" parent="1" source="159" target="164" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="159" value="&lt;div&gt;判断是否可读的逻辑&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
                    <mxGeometry x="327.53999999999996" y="3842" width="114.92" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="170" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;startArrow=classic;startFill=1;" parent="1" source="162" target="169" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="171" value="对比判断" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="170" vertex="1" connectable="0">
                    <mxGeometry x="-0.5542" y="-4" relative="1" as="geometry">
                        <mxPoint x="23" y="-4" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="162" value="" style="shape=image;imageAspect=0;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;comic=0;sketch=1;image=https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/ReadView.drawio.png;imageBorder=default;" parent="1" vertex="1">
                    <mxGeometry x="473.78" y="3792.5" width="296.22" height="139" as="geometry"/>
                </mxCell>
                <mxCell id="167" style="edgeStyle=none;sketch=1;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="165" target="173" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="401.53999999999996" y="4030" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="174" value="一个记录rd" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="167" vertex="1" connectable="0">
                    <mxGeometry x="-0.5609" relative="1" as="geometry">
                        <mxPoint y="5" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="194" style="rounded=0;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;startArrow=none;startFill=0;" parent="1" source="165" target="193" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="195" value="无记录" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="194" vertex="1" connectable="0">
                    <mxGeometry x="-0.5652" y="-1" relative="1" as="geometry">
                        <mxPoint x="11" y="-1" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="165" value="&lt;div&gt;取数据表版本链记录&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;" parent="1" vertex="1">
                    <mxGeometry x="344.08" y="3980" width="114.92" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="169" value="" style="shape=image;imageAspect=0;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;comic=0;sketch=1;image=https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/f595d13450878acd04affa82731f76c5.png;imageBorder=default;" parent="1" vertex="1">
                    <mxGeometry x="850" y="3802.5" width="320.62" height="119" as="geometry"/>
                </mxCell>
                <mxCell id="176" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;startArrow=none;startFill=0;" parent="1" source="173" target="175" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="177" value="是" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="176" vertex="1" connectable="0">
                    <mxGeometry x="-0.5124" relative="1" as="geometry">
                        <mxPoint x="5" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="181" style="edgeStyle=none;sketch=1;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;startArrow=none;startFill=0;" parent="1" source="173" target="180" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="173" value="&lt;span&gt;rd.trx_id &amp;lt; min_trx?&lt;/span&gt;" style="rhombus;whiteSpace=wrap;html=1;comic=0;sketch=0;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
                    <mxGeometry x="337.31" y="4040" width="128.46" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="175" value="&lt;div&gt;可读&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;" parent="1" vertex="1">
                    <mxGeometry x="505" y="4040" width="45" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="179" value="事务已提交，位于快照内" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;align=center;" parent="1" vertex="1">
                    <mxGeometry x="564.64" y="4040" width="145.36" height="32.5" as="geometry"/>
                </mxCell>
                <mxCell id="183" style="edgeStyle=orthogonalEdgeStyle;sketch=1;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;startArrow=none;startFill=0;rounded=0;" parent="1" source="180" target="165" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="184" value="不可读&lt;br&gt;取下一个" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="183" vertex="1" connectable="0">
                    <mxGeometry x="-0.5518" y="1" relative="1" as="geometry">
                        <mxPoint x="1" y="-8" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="187" style="rounded=0;sketch=1;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;startArrow=none;startFill=0;" parent="1" source="180" target="186" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="180" value="&lt;span&gt;rd.trx_id &amp;gt;= max_trx?&lt;/span&gt;" style="rhombus;whiteSpace=wrap;html=1;comic=0;sketch=0;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
                    <mxGeometry x="337.31" y="4092" width="128.46" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="185" value="事务未提交，不包含在快照" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;align=center;" parent="1" vertex="1">
                    <mxGeometry x="540" y="4089.5" width="160.36" height="32.5" as="geometry"/>
                </mxCell>
                <mxCell id="188" style="edgeStyle=orthogonalEdgeStyle;rounded=0;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;startArrow=none;startFill=0;" parent="1" source="186" target="175" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="189" value="否" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="188" vertex="1" connectable="0">
                    <mxGeometry x="-0.6993" y="-1" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="186" value="&lt;span&gt;rd.trx_id in m_ids?&lt;/span&gt;" style="rhombus;whiteSpace=wrap;html=1;comic=0;sketch=0;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
                    <mxGeometry x="337.31" y="4140" width="128.46" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="191" value="生成快照时该事务不活跃(已提交)，在快照内" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;align=center;" parent="1" vertex="1">
                    <mxGeometry x="556.77" y="4137.5" width="140" height="32.5" as="geometry"/>
                </mxCell>
                <mxCell id="192" value="其实&lt;b&gt;只需要m_ids和max_trx即可判断当前记录是否在快照内&lt;/b&gt;（即只进行第二和第三个判断），之所以另外使用min_trx是为了&lt;b&gt;加快判断的速度&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;align=center;" parent="1" vertex="1">
                    <mxGeometry x="740" y="4059.5" width="280" height="60.5" as="geometry"/>
                </mxCell>
                <mxCell id="193" value="&lt;div&gt;不可读&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;" parent="1" vertex="1">
                    <mxGeometry x="514.72" y="3980" width="59.92" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="199" style="edgeStyle=none;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;sketch=1;" edge="1" parent="1" source="196" target="197">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="227" style="edgeStyle=none;rounded=0;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="196" target="226">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="235" style="edgeStyle=none;rounded=0;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="196" target="234">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="196" value="幻读的解决方案" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
                    <mxGeometry x="40" y="4350" width="100" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="201" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="197" target="200">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="197" value="问题引入" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
                    <mxGeometry x="215" y="4270" width="85" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="203" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="200" target="205">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="625" y="4285" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="200" value="既然可重复读使用了MVCC机制保证了使用快照读，不就可以保证只看到上次快照的内容了吗，又怎么会多出数据呢？" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="344.08" y="4255" width="217.5" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="208" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="205" target="207">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="209" value="事务1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="208">
                    <mxGeometry x="-0.2796" y="-4" relative="1" as="geometry">
                        <mxPoint x="7" y="-11" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="211" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="205" target="210">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="212" value="事务2" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="211">
                    <mxGeometry x="-0.2569" relative="1" as="geometry">
                        <mxPoint x="8" y="4" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="225" style="rounded=0;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="205" target="224">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="205" value="&lt;span style=&quot;font-size: 11px ; background-color: rgb(255 , 255 , 255)&quot;&gt;案例&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#dae8fc;strokeColor=#6c8ebf;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="610" y="4267.5" width="60" height="35" as="geometry"/>
                </mxCell>
                <mxCell id="215" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="207" target="214">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="216" value="select 1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="215">
                    <mxGeometry x="-0.2299" y="1" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="221" style="edgeStyle=none;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="207" target="220">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="222" value="select 2" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="221">
                    <mxGeometry x="-0.415" y="-2" relative="1" as="geometry">
                        <mxPoint x="13" y="1" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="207" value="" style="shape=image;imageAspect=0;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;sketch=1;image=https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/image-20220721123131172.png;imageBorder=default;" vertex="1" parent="1">
                    <mxGeometry x="785.19" y="4180" width="199.76" height="114" as="geometry"/>
                </mxCell>
                <mxCell id="218" style="edgeStyle=orthogonalEdgeStyle;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;rounded=0;" edge="1" parent="1" source="210" target="217">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="1170.6200000000001" y="4352.5199999999995" as="sourcePoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="210" value="" style="shape=image;imageAspect=0;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;sketch=1;image=https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/image-20220721123236205.png;imageBorder=default;" vertex="1" parent="1">
                    <mxGeometry x="785.19" y="4315" width="364.77" height="83.48" as="geometry"/>
                </mxCell>
                <mxCell id="219" style="edgeStyle=none;sketch=1;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="214" target="217">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="214" value="" style="shape=image;imageAspect=0;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;sketch=1;image=https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/image-20220721123334375.png;imageBorder=default;" vertex="1" parent="1">
                    <mxGeometry x="1170.6200000000001" y="4101.53" width="207.34" height="96" as="geometry"/>
                </mxCell>
                <mxCell id="223" style="edgeStyle=none;sketch=1;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="217" target="220">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="217" value="&lt;span style=&quot;font-size: 11px ; background-color: rgb(255 , 255 , 255)&quot;&gt;commit&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#dae8fc;strokeColor=#6c8ebf;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="1244.2900000000002" y="4215.78" width="60" height="35" as="geometry"/>
                </mxCell>
                <mxCell id="220" value="" style="shape=image;imageAspect=0;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;sketch=1;image=https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/image-20220721123502339.png;imageBorder=default;" vertex="1" parent="1">
                    <mxGeometry x="1170.66" y="4275.78" width="207.3" height="96.68" as="geometry"/>
                </mxCell>
                <mxCell id="224" value="&lt;div style=&quot;text-align: left&quot;&gt;&lt;span&gt;可以看到前后两次select得到的结果是一致的，不会出现幻读现象&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;align=center;" vertex="1" parent="1">
                    <mxGeometry x="785.19" y="4420" width="254.81" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="229" style="edgeStyle=none;rounded=0;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="226" target="228">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="226" value="解答" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
                    <mxGeometry x="212.5" y="4350" width="85" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="231" style="edgeStyle=none;rounded=0;sketch=1;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="228" target="230">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="228" value="当使用&lt;b&gt;快照读时&lt;/b&gt;，确实会使用内部的MVCC机制保证了&lt;b&gt;读取的是快照定格的信息，进而不会发生幻读现象&lt;/b&gt;。因而&lt;b&gt;幻读&lt;/b&gt;其实是在&lt;b&gt;当前读&lt;/b&gt;才会发生。" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;align=left;" vertex="1" parent="1">
                    <mxGeometry x="344.08" y="4335" width="225.92" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="233" style="edgeStyle=none;rounded=0;sketch=1;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="230" target="232">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="230" value="当前读是什么？" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#dae8fc;strokeColor=#6c8ebf;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="405.56" y="4420" width="102.96" height="35" as="geometry"/>
                </mxCell>
                <mxCell id="232" value="除了普通的select语句，例如select ... for update、update、insert、delete等语句都是会操作最新的数据而非快照，因而select ... for update被称为当前读" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;align=left;" vertex="1" parent="1">
                    <mxGeometry x="319.08" y="4480" width="275.92" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="237" style="edgeStyle=none;rounded=0;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="234" target="236">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="239" style="edgeStyle=none;rounded=0;sketch=1;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="234" target="238">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="234" value="假设不存在锁机制，产生幻读现象" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
                    <mxGeometry x="204.99999999999997" y="4716.5" width="116.77" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="245" style="edgeStyle=none;rounded=0;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="236" target="243">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="236" value="" style="shape=image;imageAspect=0;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;sketch=1;image=https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/1f872ff92b644b5f81cee2dd9188b199.png;imageBorder=default;" vertex="1" parent="1">
                    <mxGeometry x="359.96" y="4560" width="380.04" height="353" as="geometry"/>
                </mxCell>
                <mxCell id="242" style="edgeStyle=none;rounded=0;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="238" target="241">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="238" value="事实上" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#b0e3e6;strokeColor=#0e8088;" vertex="1" parent="1">
                    <mxGeometry x="204.99999999999997" y="4977.5" width="116.77" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="244" style="edgeStyle=none;rounded=0;sketch=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="241" target="243">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="241" value="" style="shape=image;imageAspect=0;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;sketch=1;image=https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/3af285a8e70f4d4198318057eb955520.png;imageBorder=default;" vertex="1" parent="1">
                    <mxGeometry x="360" y="4930" width="326.51" height="135" as="geometry"/>
                </mxCell>
                <mxCell id="247" style="edgeStyle=none;rounded=0;sketch=1;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;startArrow=classic;startFill=1;" edge="1" parent="1" source="243" target="246">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="243" value="因而在RR隔离级别中，其实MySQL使用MVCC加临键锁(next-key lock)的机制保证了不出现幻读：&lt;br&gt;MVCC：保证快照度不出现幻读&lt;br&gt;临键锁：保证当前读不出现幻读" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;align=left;" vertex="1" parent="1">
                    <mxGeometry x="840" y="4810" width="275.92" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="246" value="上述情况都是在RR隔离级别的情况下讨论的，如果是RC隔离级别在快照读还是会出现幻读。" style="rounded=0;whiteSpace=wrap;html=1;comic=1;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;align=left;" vertex="1" parent="1">
                    <mxGeometry x="840" y="4913" width="275.92" height="47" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>